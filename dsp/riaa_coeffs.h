/*
 * riaa_coeffs.h - RIAA equalization coefficients and constants
 * 
 * Pre-calculated biquad coefficients for RIAA equalization and subsonic filtering
 * at various sample rates.
 */

#ifndef RIAA_COEFFS_H
#define RIAA_COEFFS_H

#include "biquad.h"
#include "samplerate.h"

// RIAA equalization coefficients - Wayne Stegall implementation
// Derived from: http://waynestegall.com/audio/riaaiir.htm
// Gain: 1, Extra zero: 1, Inverse: 0
// Digital transfer function H(z) = num[0] + num[1]*z^-1 + num[2]*z^-2 / den[0] + den[1]*z^-1 + den[2]*z^-2
static const BiquadCoeffs RIAA_COEFFS[NUM_SAMPLE_RATES] = {
    // 44.1kHz
    // num[0] = 2.695829e-002, [1] = -2.512448e-002, [2] = 2.008562e-005
    // den[0] = 1.000000e+000, [1] = -1.731979e+000, [2] = 7.338329e-001
    {2.695829e-002, -2.512448e-002, 2.008562e-005, 1.731979e+000, -7.338329e-001},
    
    // 48kHz
    // num[0] = 2.501045e-002, [1] = -2.346016e-002, [2] = 3.345404e-005
    // den[0] = 1.000000e+000, [1] = -1.750935e+000, [2] = 7.525189e-001
    {2.501045e-002, -2.346016e-002, 3.345404e-005, 1.750935e+000, -7.525189e-001},
    
    // 88.2kHz
    // num[0] = 1.467115e-002, [1] = -1.457228e-002, [2] = 4.004612e-004
    // den[0] = 1.000000e+000, [1] = -1.856141e+000, [2] = 8.566405e-001
    {1.467115e-002, -1.457228e-002, 4.004612e-004, 1.856141e+000, -8.566405e-001},
    
    // 96kHz
    // num[0] = 1.367635e-002, [1] = -1.375246e-002, [2] = 5.001887e-004
    // den[0] = 1.000000e+000, [1] = -1.867054e+000, [2] = 8.674785e-001
    {1.367635e-002, -1.375246e-002, 5.001887e-004, 1.867054e+000, -8.674785e-001},
    
    // 172.8kHz (176.4kHz slot - closest match to 172.8kHz)
    // num[0] = 8.934748e-003, [1] = -1.022154e-002, [2] = 1.421804e-003
    // den[0] = 1.000000e+000, [1] = -1.923923e+000, [2] = 9.240581e-001
    {8.934748e-003, -1.022154e-002, 1.421804e-003, 1.923923e+000, -9.240581e-001},
    
    // 192kHz
    // num[0] = 8.389216e-003, [1] = -9.883791e-003, [2] = 1.604365e-003
    // den[0] = 1.000000e+000, [1] = -1.931275e+000, [2] = 9.313852e-001
    {8.389216e-003, -9.883791e-003, 1.604365e-003, 1.931275e+000, -9.313852e-001}
};

// Subsonic 1st order highpass at 20Hz (-6dB/octave)
static const BiquadCoeffs SUBSONIC_1ST_ORDER_COEFFS[NUM_SAMPLE_RATES] = {
    {0.9985772675, -0.9985772675, 0.0, 0.9971545350, 0.0},  // 44.1 kHz
    {0.9986927135, -0.9986927135, 0.0, 0.9973854271, 0.0},  // 48.0 kHz
    {0.9992881277, -0.9992881277, 0.0, 0.9985762554, 0.0},  // 88.2 kHz
    {0.9993459295, -0.9993459295, 0.0, 0.9986918591, 0.0},  // 96.0 kHz
    {0.9996439372, -0.9996439372, 0.0, 0.9992878743, 0.0},  // 176.4 kHz
    {0.9996728578, -0.9996728578, 0.0, 0.9993457156, 0.0}   // 192.0 kHz
};

// Subsonic 2nd order Butterworth highpass at 20Hz (-12dB/octave)
static const BiquadCoeffs SUBSONIC_2ND_ORDER_COEFFS[NUM_SAMPLE_RATES] = {
    {0.9979868126, -1.9959736252, 0.9979868126, 1.9959695735, -0.9959776769},  // 44.1 kHz
    {0.9981502326, -1.9963004653, 0.9981502326, 1.9962970446, -0.9963038859},  // 48.0 kHz
    {0.9989928990, -1.9979857980, 0.9989928990, 1.9979847841, -0.9979868120},  // 88.2 kHz
    {0.9990746881, -1.9981493762, 0.9990746881, 1.9981485202, -0.9981502321},  // 96.0 kHz
    {0.9994963226, -1.9989926452, 0.9994963226, 1.9989923916, -0.9989928989},  // 176.4 kHz
    {0.9995372369, -1.9990744739, 0.9995372369, 1.9990742598, -0.9990746880}   // 192.0 kHz
};

#endif // RIAA_COEFFS_H
